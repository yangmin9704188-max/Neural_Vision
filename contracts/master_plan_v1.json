{
  "schema_version": "master_plan.v1",
  "updated_at": "2026-02-08T02:00:00+09:00",
  "principles": {
    "enforcement": "warn-only",
    "no_fail": true,
    "ssot": "this file (contracts/master_plan_v1.json)"
  },
  "agents": {
    "body_llm": { "label": "Body LLM" },
    "fitting_llm": { "label": "Fitting LLM" },
    "garment_llm": { "label": "Garment LLM" }
  },
  "artifacts": {
    "body_subset_m0": {
      "label": "body_measurements_subset.json (M0)",
      "path_glob_any": [
        "exports/runs/*/*/body_measurements_subset.json",
        "exports/runs/*/*/*/body_measurements_subset.json"
      ]
    },
    "garment_proxy_meta_m0": {
      "label": "garment_proxy_meta.json (M0)",
      "path_glob_any": [
        "exports/runs/*/*/garment_proxy_meta.json",
        "exports/runs/*/*/*/garment_proxy_meta.json"
      ]
    },
    "geometry_manifest_root": {
      "label": "geometry_manifest.json (run 루트)",
      "path_glob_any": ["exports/runs/*/*/geometry_manifest.json"]
    },
    "facts_summary_root": {
      "label": "facts_summary.json (run 루트)",
      "path_glob_any": ["exports/runs/*/*/facts_summary.json"]
    }
  },
  "maturity_levels": {
    "M0": { "label": "M0 (stub 허용)", "checks": [{"check_id": "run_minset_present", "type": "run_minset", "min_count": 2, "files_any": ["geometry_manifest.json", "facts_summary.json", "RUN_README.md"], "severity": "warn"}] },
    "M1": { "label": "M1 (정합성 최소)", "checks": [{"check_id": "manifest_has_fp_or_inputs_fp", "type": "json_fields_any", "path": "geometry_manifest.json", "fields_any": ["fingerprint", "inputs_fingerprint"], "severity": "warn"}] },
    "M2": { "label": "M2 (KPI 기반)", "checks": [{"check_id": "kpi_present", "type": "file_exists", "path": "kpi.json", "severity": "warn"}] }
  },
  "plan_items": [
    {"plan_id": "P0.body.emit_subset_m0", "module": "body", "title": "Body: body_measurements_subset.json (M0) 생성", "status_hint": "In progress", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "body_llm", "done_when": {"type": "artifact_observed", "artifact_id": "body_subset_m0"}, "action_ko": "body_measurements_subset.json (M0) 생성 후 run_dir에 출력"},
    {"plan_id": "P0.body.subset_m1_unit", "module": "body", "title": "Body: subset M1 단위(unit=m) 검증", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M1", "target_agent": "body_llm", "done_when": {"type": "artifact_observed", "artifact_id": "body_subset_m1"}, "action_ko": "subset M1: unit=m / NaN 금지 체크 추가 (warn-only 유지)"},
    {"plan_id": "P0.body.subset_m1_nan", "module": "body", "title": "Body: subset M1 NaN 금지 체크", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M1", "target_agent": "body_llm", "done_when": {"type": "artifact_observed", "artifact_id": "body_subset_m1_nan"}, "action_ko": "NaN/Infinity 금지 검증 추가 후 ROUND_END evidence_paths 포함"},
    {"plan_id": "P0.body.run_minset", "module": "body", "title": "Body: run 루트 minset 3종 확보", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "body_llm", "done_when": {"type": "and", "items": [{"type": "artifact_observed", "artifact_id": "geometry_manifest_root"}, {"type": "artifact_observed", "artifact_id": "facts_summary_root"}]}, "action_ko": "run_dir 루트에 geometry_manifest, facts_summary, RUN_README 보장"},
    {"plan_id": "P0.garment.emit_proxy_meta_m0", "module": "garment", "title": "Garment: garment_proxy_meta.json (M0) 생성", "status_hint": "In progress", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "garment_llm", "done_when": {"type": "artifact_observed", "artifact_id": "garment_proxy_meta_m0"}, "action_ko": "garment_proxy_meta.json (M0) 생성 후 run_dir에 출력"},
    {"plan_id": "P0.garment.proxy_meta_m1_fields", "module": "garment", "title": "Garment: proxy_meta M1 필드 보강", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M1", "target_agent": "garment_llm", "done_when": {"type": "artifact_observed", "artifact_id": "garment_proxy_meta_m1"}, "action_ko": "proxy_meta M1: 필드 보강 + ROUND_END evidence_paths 포함"},
    {"plan_id": "P0.garment.proxy_meta_round_end", "module": "garment", "title": "Garment: ROUND_END evidence_paths 포함", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "garment_llm", "done_when": {"type": "artifact_observed", "artifact_id": "garment_proxy_meta_m0"}, "action_ko": "ROUND_END 시 evidence_paths에 proxy_meta 경로 포함"},
    {"plan_id": "P0.garment.run_minset", "module": "garment", "title": "Garment: run 루트 minset 3종 확보", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "garment_llm", "done_when": {"type": "and", "items": [{"type": "artifact_observed", "artifact_id": "geometry_manifest_root"}, {"type": "artifact_observed", "artifact_id": "facts_summary_root"}]}, "action_ko": "run_dir 루트에 geometry_manifest, facts_summary, RUN_README 보장"},
    {"plan_id": "P0.fitting.u1_ready", "module": "fitting", "title": "Fitting: U1 입력 준비 완료", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "fitting_llm", "done_when": {"type": "and", "items": [{"type": "artifact_observed", "artifact_id": "body_subset_m0"}, {"type": "artifact_observed", "artifact_id": "garment_proxy_meta_m0"}]}, "action_ko": "U1 validator(strict-run) 착수 전 body/garment 산출물 확인"},
    {"plan_id": "P0.fitting.u1_validator_run", "module": "fitting", "title": "Fitting: U1 validator(strict-run) 실행", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "fitting_llm", "done_when": {"type": "artifact_observed", "artifact_id": "fitting_u1_validated"}, "action_ko": "U1 validator(strict-run) 실행/보강 후 ROUND_END 남기기"},
    {"plan_id": "P0.fitting.round_end_minset", "module": "fitting", "title": "Fitting: ROUND_END minset 3종 포함", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "fitting_llm", "done_when": {"type": "and", "items": [{"type": "artifact_observed", "artifact_id": "geometry_manifest_root"}, {"type": "artifact_observed", "artifact_id": "facts_summary_root"}]}, "action_ko": "ROUND_END evidence_paths에 run_minset(geometry_manifest/facts_summary/RUN_README) 포함"},
    {"plan_id": "P0.fitting.backfill_step_id", "module": "fitting", "title": "Fitting: STEP_ID backfill (누락 이력 정리)", "status_hint": "Todo", "unlock_target": "U1", "maturity_target": "M0", "target_agent": "fitting_llm", "done_when": {"type": "artifact_observed", "artifact_id": "fitting_step_id_backfilled"}, "action_ko": "STEP_ID 누락 구간에 BACKFILL 이벤트 1줄 + gate_code STEP_ID_BACKFILLED"}
  ],
  "unlocks": [
    {"unlock_id": "U1.FITTING_READY", "title": "✅ [FITTING] U1 언락: 입력 준비 완료", "logic": {"type": "and", "items": [{"type": "artifact_observed", "artifact_id": "body_subset_m0"}, {"type": "artifact_observed", "artifact_id": "garment_proxy_meta_m0"}]}, "on_unlocked": {"target_agent": "fitting_llm", "brief_id": "LLM_SYNC_FITTING_U1_READY", "brief_path": "exports/brief/LLM_SYNC_FITTING_U1_READY.txt", "template_ko": ["현재 상황: Body에서 body_measurements_subset.json(M0)이 관측되었습니다.", "현재 상황: Garment에서 garment_proxy_meta.json(M0)이 관측되었습니다.", "언락 소식: 이로 인해 Fitting의 U1 입력 준비가 완료되었습니다. (unlock_id=U1.FITTING_READY)", "", "다음 지시(바로 할 일):", "1) Fitting 모듈에서 U1 입력 검증(strict-run, warn-only)을 실행/보강하세요.", "2) ROUND_END 시 evidence_paths에 run_minset(geometry_manifest/facts_summary/RUN_README)을 반드시 포함시키세요.", "3) 결과를 PROGRESS_LOG.jsonl에 ROUND_END로 남기고, 새 run_dir 루트에 minset 3종이 존재하도록 보장하세요."]}, "dashboard_pin": true}
  ],
  "dashboard": {
    "title": "Neural Vision Dashboard",
    "top_sections": ["newly_unlocked", "current_unlocked", "locked", "blockers", "next_actions", "modules"],
    "limits": {"newly_unlocked": 10, "blockers": 10, "locked": 10, "next_actions_per_module": 3}
  }
}
